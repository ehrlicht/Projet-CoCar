<!DOCTYPE html>

<html>
<head>
    <title>Inscription</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" language="Javascript" src="/js/fonctions.js"></script>
</head>
<body>
<div class="container">

    <form id="signup">

        <div class="header">

            <h3 style="text-align: center">Inscription au service CoCar</h3>

            <p style="text-align: center">Pour vous inscrire, veuillez SVP saisir votre email</p>

        </div>

        <div class="sep"></div>
        <div id="site" class="inputs">
            <input id="email" type="email" placeholder="e-mail" autofocus />

            <div style="color:#ff0000;" id="resultat"></div>

            <a id="submit" href="#">S'inscrire</a> <br>
            <div class="sep"></div>
            <p style="text-align:center;">Déjà inscrit ?</p>
            <a id="btnConnexion" href="#" >Se connecter</a>

        </div>

    </form>

</div>

<script type="text/javascript">
    function validEmail(v) {
        var r = new RegExp("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?");
        return (v.match(r) == null) ? false : true;
    }
    $("#submit").click(function(){
        var email = $("#email").val();
        if(validEmail(email)){
            var jqxhr =  $.post( "http://groups.cowaboo.net/2018/group01/public/api/user?email="+email);
            jqxhr.done(function( data ) {
                window.location="/signupSuccessful";
            });
            jqxhr.fail(function(data){
                $("#resultat").text("Cet email n'est pas disponible.");
            })
        }
        else{
            $("#resultat").text("Veuillez SVP saisir un email valide.");
        }
    });


    $("#btnConnexion").click(function(){
        window.location = '/connexion';
    });

</script>
</body>
</html>
